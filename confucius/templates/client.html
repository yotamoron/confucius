<!doctype html>

<?xml version="1.0" encoding="UTF-8"?>
<html xmlns='http://www.w3.org/1999/xhtml' xmlns:v="urn:schemas-microsoft-com:vml">
<head>
	<link rel="stylesheet" href="http://jsplumbtoolkit.com//demo-all.css">
	<link rel="stylesheet" href="http://jsplumbtoolkit.com/home/demo.css">
	<link rel="stylesheet" href="../static/css/jquery.contextMenu.css">
</head>

<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js'></script>
<script type='text/javascript' src='http://jsplumbtoolkit.com/lib/jquery.ui.touch-punch.min.js'></script>
<script type='text/javascript' src='http://jsplumbtoolkit.com/js/jquery.jsPlumb-1.5.2-min.js'></script>

<script type='text/javascript' src='../static/js/jquery.contextMenu.js'></script>
<script type='text/javascript' src='../static/js/model_serializer.js'></script>
<script type='text/javascript' src='../static/js/addSource.js'></script>
<script type='text/javascript' src='../static/js/addElement.js'></script>
<script type='text/javascript' src='../static/js/plumb.js'></script>
<script type='text/javascript' src='../static/js/client.js'></script>

<script>
	jsPlumb.bind("ready", function() {        
		configurePlumba();
	});

	$(document).ready(function() {
		$("#btnAddSource").click(function(){
		
			var counterId = Math.floor((Math.random()*100000000)+1);
			var divId = "window" + counterId;			
			addSource(divId, "Source");
			configurePlumbSource(divId);
		});
		
		$("#btnAddElement").click(function(){
			var counterId = Math.floor((Math.random()*100000000)+1);
			var divId = "window" + counterId;
			addElement(divId, $("#transformerType").val(),  $("#transformerType").val());
			configurePlumbElement(divId, BOTH_ANCHORS);
        });
        $.contextMenu({
            selector: '.component', 
            callback: function(key, options) {
                <!-- Roy, here is where you can call the delete function you carved -->
                console.log($(this), key); 
            },
            items: {
                "edit": {name: "Edit", icon: "edit"},
                "delete": {name: "Delete", icon: "delete"},
            }
        });
	});

</script>
	<body>
		<br>
		<button type="button" id="btnAddSource">Add Stream Source</button>
		<button type="button" id="btnAddElement">Add element</button>
		<select id="transformerType">
		  <option value="where">Where?</option>
		  <option value="rollup">Rollup</option>
		  <option value="rate">Rate</option>
		  <option value="email">Email</option>
		</select>
		<button type="button" id="btnSave">Save changes</button>
        <div id="main">
			<div id="render"></div>	

        </div>
        
    </body>
</html>
